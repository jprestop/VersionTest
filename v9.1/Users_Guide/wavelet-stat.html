

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>10. Wavelet-Stat Tool &mdash; MET 9.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="MET 9.1 documentation" href="../index.html"/>
        <link rel="up" title="User’s Guide" href="index.html"/>
        <link rel="next" title="11. GSI Tools" href="gsi-tools.html"/>
        <link rel="prev" title="9. Ensemble-Stat Tool" href="ensemble-stat.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> MET
          

          
            
            <img src="../_static/met_logo_2019_09.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                
                  9.1
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Model Evaluation Tools</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">1. Overview of MET</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html">2. Software Installation/Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_io.html">3. MET Data I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="reformat_point.html">4. Re-Formatting of Point Observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="reformat_grid.html">5. Re-Formatting of Gridded Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="masking.html">6. Regional Verification using Spatial Masking</a></li>
<li class="toctree-l2"><a class="reference internal" href="point-stat.html">7. Point-Stat Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="grid-stat.html">8. Grid-Stat Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="ensemble-stat.html">9. Ensemble-Stat Tool</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">10. Wavelet-Stat Tool</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">10.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scientific-and-statistical-aspects">10.2. Scientific and statistical aspects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-method">10.2.1. The method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-spatial-domain-constraints">10.2.2. The spatial domain constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="#aggregation-of-statistics-on-multiple-cases">10.2.3. Aggregation of statistics on multiple cases</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#practical-information">10.3. Practical information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wavelet-stat-usage">10.3.1. wavelet_stat usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavelet-stat-configuration-file">10.3.2. wavelet_stat configuration file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavelet-stat-output">10.3.3. wavelet_stat output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gsi-tools.html">11. GSI Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="stat-analysis.html">12. Stat-Analysis Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="series-analysis.html">13. Series-Analysis Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="grid-diag.html">14. Grid-Diag Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="mode.html">15. MODE Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="mode-analysis.html">16. MODE-Analysis Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="mode-td.html">17. MODE Time Domain Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="met-tc_overview.html">18. MET-TC Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="tc-dland.html">19. TC-Dland Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="tc-pairs.html">20. TC-Pairs Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="tc-stat.html">21. TC-Stat Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="tc-gen.html">22. TC-Gen Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="tc-rmw.html">23. TC-RMW Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="rmw-analysis.html">24. RMW-Analysis Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">25. Plotting and Graphics Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="refs.html">26. References</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixA.html">27. Appendix A FAQs &amp; How do I … ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixB.html">28. Appendix B Map Projections, Grids, and Polylines</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixC.html">29. Appendix C Verification Measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixD.html">30. Appendix D Confidence Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixE.html">31. Appendix E WWMCA Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixF.html">32. Appendix F Python Embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixG.html">33. Appendix G Vectors and Vector Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Contributors_Guide/index.html">Contributor’s Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MET</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">User’s Guide</a> &raquo;</li>
        
      <li><span class="section-number">10. </span>Wavelet-Stat Tool</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Users_Guide/wavelet-stat.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="wavelet-stat-tool">
<span id="wavelet-stat"></span><h1><span class="section-number">10. </span>Wavelet-Stat Tool<a class="headerlink" href="#wavelet-stat-tool" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<span id="ws-introduction"></span><h2><span class="section-number">10.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Wavelet-Stat tool decomposes two-dimensional forecasts and observations according to intensity and scale. This section describes the Wavelet-Stat tool, which enables users to apply the Intensity-Scale verification technique described by <a class="reference internal" href="refs.html#casati-2004"><span class="std std-ref">Casati et al (2004)</span></a>.</p>
<p>The Intensity-Scale technique is one of the recently developed verification approaches that focus on verification of forecasts defined over spatial domains. Spatial verification approaches, as opposed to point-by-point verification approaches, aim to account for the presence of features and for the coherent spatial structure characterizing meteorological fields. Since these approaches account for the intrinsic spatial correlation existing between nearby grid-points, they do not suffer from point-by-point comparison related verification issues, such as double penalties. Spatial verification approaches aim to account for the observation and forecast time-space uncertainties, and aim to provide feedback on the forecast error in physical terms.</p>
<p>The Intensity-Scale verification technique, as most of the spatial verification approaches, compares a forecast field to an observation field. To apply the Intensity-Scale verification approach, observations need to be defined over the same spatial domain of the forecast to be verified.</p>
<p>Within the spatial verification approaches, the Intensity-Scale technique belongs to the scale-decomposition (or scale-separation) verification approaches. The scale-decomposition approaches enable users to perform the verification on different spatial scales. Weather phenomena on different scales (e.g. frontal systems versus convective showers) are often driven by different physical processes. Verification on different spatial scales can therefore provide deeper insights into model performance at simulating these different processes.</p>
<p>The spatial scale components are obtained usually by applying a single band spatial filter to the forecast and observation fields (e.g. Fourier, Wavelets). The scale-decomposition approaches measure error, bias and skill of the forecast on each different scale component. The scale-decomposition approaches therefore provide feedback on the scale dependency of the error and skill, on the no-skill to skill transition scale, and on the capability of the forecast of reproducing the observed scale structure.</p>
<p>The Intensity-Scale technique evaluates the forecast skill as a function of the intensity values and of the spatial scale of the error. The scale components are obtained by applying a two dimensional Haar wavelet filter. Note that wavelets, because of their locality, are suitable for representing discontinuous fields characterized by few sparse non-zero features, such as precipitation. Moreover, the technique is based on a categorical approach, which is a robust and resistant approach, suitable for non-normally distributed variables, such as precipitation. The intensity-scale technique was specifically designed to cope with the difficult characteristics of precipitation fields, and for the verification of spatial precipitation forecasts. However, the intensity-scale technique can also be applied to verify other variables, such as cloud fraction.</p>
</div>
<div class="section" id="scientific-and-statistical-aspects">
<h2><span class="section-number">10.2. </span>Scientific and statistical aspects<a class="headerlink" href="#scientific-and-statistical-aspects" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-method">
<h3><span class="section-number">10.2.1. </span>The method<a class="headerlink" href="#the-method" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="refs.html#casati-2004"><span class="std std-ref">Casati et al (2004)</span></a> applied the Intensity-Scale verification to preprocessed and re-calibrated (unbiased) data. The preprocessing was aimed to mainly normalize the data, and defined categorical thresholds so that each categorical bin had a similar sample size. The recalibration was performed to eliminate the forecast bias. Preprocessing and recalibration are not strictly necessary for the application of the Intensity-Scale technique. The MET Intensity-Scale Tool does not perform either, and applies the Intensity-Scale approach to biased forecasts, for categorical thresholds defined by the user.</p>
<p>The Intensity Scale approach can be summarized in the following 5 steps:</p>
<ol class="arabic simple">
<li><p>For each threshold, the forecast and observation fields are transformed into binary fields: where the grid-point precipitation value meets the threshold criteria it is assigned 1, where the threshold criteria are not met it is assigned 0. <a class="reference internal" href="#wavelet-stat-nimrod-3h-fcst"><span class="std std-numref">Figure 10.1</span></a> illustrates an example of a forecast and observation fields, and their corresponding binary fields for a threshold of 1mm/h. This case shows an intense storm of the scale of 160 km displaced almost its entire length. The displacement error is clearly visible from the binary field difference and the contingency table image obtained for the same threshold <a class="reference internal" href="#contingency-table-counts"><span class="std std-numref">Table 10.1</span></a>.</p></li>
<li><p>The binary forecast and observation fields obtained from the thresholding are then decomposed into the sum of components on different scales, by using a 2D Haar wavelet filter (<a class="reference internal" href="#wavelet-stat-nimrod-diff"><span class="std std-numref">Figure 10.3</span></a>). Note that the scale components are fields, and their sum adds up to the original binary field. For a forecast defined over square domain of <strong>2ⁿ x 2ⁿ</strong> grid-points, the scale components are <strong>n+1: n</strong> mother wavelet components + the largest father wavelet (or scale-function) component. The <strong>n</strong> mother wavelet components have resolution equal to <strong>1, 2, 4, …</strong> <span class="math notranslate nohighlight">\(\mathbf{2^{n-1}}\)</span>  grid-points. The largest father wavelet component is a constant field over the <strong>2ⁿ x 2ⁿ</strong> grid-point domain with value equal to the field mean.</p></li>
</ol>
<p><strong>Note</strong> that the wavelet transform is a linear operator: this implies that the difference of the spatial scale components of the binary forecast and observation fields (<a class="reference internal" href="#wavelet-stat-nimrod-diff"><span class="std std-numref">Figure 10.3</span></a>) are equal to the spatial scale components of the difference of the binary forecast and observation fields (<a class="reference internal" href="#wavelet-stat-nimrod-binary-fcst-and-obs"><span class="std std-numref">Figure 10.2</span></a>), and these scale components also add up to the original binary field difference (<a class="reference internal" href="#wavelet-stat-nimrod-3h-fcst"><span class="std std-numref">Figure 10.1</span></a>). The intensity-scale technique considers thus the spatial scale of the error. For the case illustrated (<a class="reference internal" href="#wavelet-stat-nimrod-3h-fcst"><span class="std std-numref">Figure 10.1</span></a> and <a class="reference internal" href="#wavelet-stat-nimrod-binary-fcst-and-obs"><span class="std std-numref">Figure 10.2</span></a>) note the large error associated at the scale of 160 km, due the storm, 160km displaced almost its entire length.</p>
<p><strong>Note</strong> also that the means of the binary forecast and observation fields (i.e. their largest father wavelet components) are equal to the proportion of forecast and observed events above the threshold, <strong>(a+b)/n</strong> and <strong>(a+c)/n</strong>, evaluated from the contingency table counts (<a class="reference internal" href="#contingency-table-counts"><span class="std std-numref">Table 10.1</span></a>) obtained from the original forecast and observation fields by thresholding with the same threshold used to obtain the binary forecast and observation fields. This relation is intuitive when observing forecast and observation binary fields and their corresponding contingency table image (<a class="reference internal" href="#wavelet-stat-nimrod-3h-fcst"><span class="std std-numref">Figure 10.1</span></a>). The comparison of the largest father wavelet component of binary forecast and observation fields therefore provides feedback on the whole field bias.</p>
<ol class="arabic simple" start="3">
<li><p>For each threshold (<strong>t</strong>) and for each scale component (<strong>j</strong>) of the binary forecast and observation, the Mean Squared Error (MSE) is then evaluated (<a class="reference internal" href="#wavelet-stat-mse-percent-nimrod"><span class="std std-numref">Figure 10.4</span></a>). The error is usually large for small thresholds, and decreases as the threshold increases. This behavior is partially artificial, and occurs because the smaller the threshold the more events will exceed it, and therefore the larger would be the error, since the error tends to be proportional to the amount of events in the binary fields. The artificial effect can be diminished by normalization: because of the wavelet orthogonal properties, the sum of the MSE of the scale components is equal to the MSE of the original binary fields: <span class="math notranslate nohighlight">\(MSE(t) = j  MSE(t,j)\)</span>. Therefore, the percentage that the MSE for each scale contributes to the total MSE may be computed: for a given threshold, <strong>t</strong>, <span class="math notranslate nohighlight">\({MSE\%}(t,j) = {MSE}(t,j)/ {MSE}(t)\)</span>. The MSE% does not exhibit the threshold dependency, and usually shows small errors on large scales and large errors on small scales, with the largest error associated to the smallest scale and highest threshold. For the NIMROD case illustrated, note the large error at 160 km and between the thresholds of and 4 mm/h, due to the storm, 160km displaced almost its entire length.</p></li>
</ol>
<p><strong>Note</strong> that the MSE of the original binary fields is equal to the proportion of the counts of misses (<strong>c/n</strong>) and false alarms (<strong>b/n</strong>) for the contingency table (<a class="reference internal" href="#contingency-table-counts"><span class="std std-numref">Table 10.1</span></a>) obtained from the original forecast and observation fields by thresholding with the same threshold used to obtain the binary forecast and observation fields: <span class="math notranslate nohighlight">\({MSE}(t)=(b+c)/n\)</span>. This relation is intuitive when comparing the forecast and observation binary field difference and their corresponding contingency table image (<a class="reference internal" href="#contingency-table-counts"><span class="std std-numref">Table 10.1</span></a>).</p>
<ol class="arabic simple" start="4">
<li><p>The MSE for the random binary forecast and observation fields is estimated by <span class="math notranslate nohighlight">\({MSE}(t) {random}= {FBI}*{Br}*(1-{Br}) + {Br}*(1- {FBI}*{Br})\)</span>, where  <span class="math notranslate nohighlight">\({FBI}=(a+b)/(a+c)\)</span> is the frequency bias index and <span class="math notranslate nohighlight">\({Br}=(a+c)/n\)</span> is the sample climatology from the contingency table (<a class="reference internal" href="#contingency-table-counts"><span class="std std-numref">Table 10.1</span></a>) obtained from the original forecast and observation fields by thresholding with the same threshold used to obtain the binary forecast and observation fields. This formula follows by considering the <a class="reference internal" href="refs.html#murphy-1987"><span class="std std-ref">Murphy and Winkler (1987)</span></a> framework, applying the Bayes’ theorem to express the joint probabilities <strong>b/n</strong> and <strong>c/n</strong> as product of the marginal and conditional probability (e.g. <a class="reference internal" href="refs.html#jolliffe-2012"><span class="std std-ref">Jolliffe and Stephenson (2012)</span></a>; <a class="reference internal" href="refs.html#wilks-2010"><span class="std std-ref">Wilks, 2006</span></a>), and then noticing that for a random forecast the conditional probability is equal to the unconditional one, so that <strong>b/n</strong> and <strong>c/n</strong> are equal to the product of the corresponding marginal probabilities solely.</p></li>
<li><p>For each threshold (<strong>t</strong>) and scale component (<strong>j</strong>), the skill score based on the MSE of binary forecast and observation scale components is evaluated (<a class="reference internal" href="#wavelet-stat-intensity-scale-skill-score-nimrod"><span class="std std-numref">Figure 10.5</span></a>). The standard skill score definition as in <a class="reference internal" href="refs.html#jolliffe-2012"><span class="std std-ref">Jolliffe and Stephenson (2012)</span></a> or <a class="reference internal" href="refs.html#wilks-2010"><span class="std std-ref">Wilks, 2006</span></a> is used, and random chance is used as reference forecast. The MSE for the random binary forecast is equipartitioned on the <strong>n+1</strong> scales to evaluate the skill score: <span class="math notranslate nohighlight">\({SS} (t,j)=1- {MSE}(t,j)*(n+1)/ {MSE}(t) {random}\)</span></p></li>
</ol>
<p>The Intensity-Scale (IS) skill score evaluates the forecast skill as a function of the precipitation intensity and of the spatial scale of the error. Positive values of the IS skill score are associated to a skillful forecast, whereas negative values are associated to no skill. Usually large scales exhibit positive skill (large scale events, such as fronts, are well predicted), whereas small scales exhibit negative skill (small scale events, such as convective showers, are less predictable), and the smallest scale and highest thresholds exhibit the worst skill. For the NIMROD case illustrated note the negative skill associated to the 160 km scale, for the thresholds to 4 mm/h, due to the 160 km storm displaced almost its entire length.</p>
<span id="contingency-table-counts"></span><table class="colwidths-auto docutils align-default" id="id3">
<caption><span class="caption-number">Table 10.1 </span><span class="caption-text">2x2 contingency table in terms of counts. The <span class="math notranslate nohighlight">\(\mathbf{n}_\mathbf{ij}\)</span> values in the table represent the counts in each forecast-observation category, where <strong>i</strong> represents the forecast and <strong>j</strong> represents the observations.</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Forecast</p></th>
<th class="head"><p>Observation</p></th>
<th class="head"></th>
<th class="head"><p>Total</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p>o = 1 (e.g., “Yes”)</p></td>
<td><p>o = 0 (e.g., “No”)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>f = 1 (e.g., “Yes”)</p></td>
<td><p>Hits <strong>= a</strong></p></td>
<td><p>False Alarms <strong>= b</strong></p></td>
<td><p><strong>a+b</strong></p></td>
</tr>
<tr class="row-even"><td><p>f = 0 (e.g., “No”)</p></td>
<td><p>Misses <strong>= c</strong></p></td>
<td><p>Correct rejections <strong>= d</strong></p></td>
<td><p><strong>c+d</strong></p></td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p><strong>a+c</strong></p></td>
<td><p><strong>b+d</strong></p></td>
<td><p><strong>a+b+c+d</strong></p></td>
</tr>
</tbody>
</table>
<div class="figure align-default" id="id4">
<span id="wavelet-stat-nimrod-3h-fcst"></span><img alt="../_images/wavelet-stat_NIMROD_3h_fcst.png" src="../_images/wavelet-stat_NIMROD_3h_fcst.png" />
<p class="caption"><span class="caption-number">Figure 10.1 </span><span class="caption-text">NIMROD 3h lead-time forecast and corresponding verifying analysis field (precipitation rate in mm/h, valid the 05/29/99 at 15:00 UTC); forecast and analysis binary fields obtained for a threshold of 1mm/h, the binary field difference has their corresponding Contingency Table Image (see <a class="reference internal" href="#contingency-table-counts"><span class="std std-numref">Table 10.1</span></a>). The forecast shows a storm of 160 km displaced almost its entire length.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id5">
<span id="wavelet-stat-nimrod-binary-fcst-and-obs"></span><img alt="../_images/wavelet-stat_NIMROD_binary_fcst_and_obs.png" src="../_images/wavelet-stat_NIMROD_binary_fcst_and_obs.png" />
<p class="caption"><span class="caption-number">Figure 10.2 </span><span class="caption-text">NIMROD binary forecast (top) and binary analysis (bottom) spatial scale components obtained by a 2D Haar wavelet transform (th=1 mm/h). Scale 1 to 8 refer to mother wavelet components (5, 10, 20, 40, 80, 160, 320, 640 km resolution); scale 9 refer to the largest father wavelet component (1280 km resolution).</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id6">
<span id="wavelet-stat-nimrod-diff"></span><img alt="../_images/wavelet-stat_NIMROD_diff.png" src="../_images/wavelet-stat_NIMROD_diff.png" />
<p class="caption"><span class="caption-number">Figure 10.3 </span><span class="caption-text">NIMROD binary field difference spatial scale components obtained by a 2D Haar wavelet transform (th=1 mm/h). Scales 1 to 8 refer to mother wavelet components (5, 10, 20, 40, 80, 160, 320, 640 km resolution); scale 9 refers to the largest father wavelet component (1280 km resolution). Note the large error at the scale 6 = 160 km, due to the storm, 160 km displaced almost of its entire length.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id7">
<span id="wavelet-stat-mse-percent-nimrod"></span><img alt="../_images/wavelet-stat_MSE_percent_NIMROD.png" src="../_images/wavelet-stat_MSE_percent_NIMROD.png" />
<p class="caption"><span class="caption-number">Figure 10.4 </span><span class="caption-text">MSE and MSE % for the NIMROD binary forecast and analysis spatial scale components. In the MSE%, note the large error associated to the scale 6 = 160 km, for the thresholds ½ to 4 mm/h, associated to the displaced storm.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id8">
<span id="wavelet-stat-intensity-scale-skill-score-nimrod"></span><img alt="../_images/wavelet-stat_Intensity_Scale_skill_score_NIMROD.png" src="../_images/wavelet-stat_Intensity_Scale_skill_score_NIMROD.png" />
<p class="caption"><span class="caption-number">Figure 10.5 </span><span class="caption-text">Intensity-Scale skill score for the NIMROD forecast and analysis shown in <a class="reference internal" href="#wavelet-stat-nimrod-3h-fcst"><span class="std std-numref">Figure 10.1</span></a>. The skill score is a function of the intensity of the precipitation rate and spatial scale of the error. Note the negative skill associated to the scale 6 = 160 km, for the thresholds to 4 mm/h, associated to the displaced storm.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<p>In addition to the MSE and the SS, the energy squared is also evaluated, for each threshold and scale (<a class="reference internal" href="#wavelet-stat-energy-squared-nimrod"><span class="std std-numref">Figure 10.6</span></a>). The energy squared of a field X is the average of the squared values: <span class="math notranslate nohighlight">\({En2}(X)= \sum_i x_i^2\)</span>. The energy squared provides feedback on the amount of events present in the forecast and observation fields for each scale, for a given threshold. Usually, small thresholds are associated to a large energy, since many events exceed the threshold. Large thresholds are associated to a small energy, since few events exceed the threshold. Comparison of the forecast and observed squared energy provide feedback on the bias on different scales, for each threshold.</p>
<div class="figure align-default" id="id9">
<span id="wavelet-stat-energy-squared-nimrod"></span><img alt="../_images/wavelet-stat_energy_squared_NIMROD.png" src="../_images/wavelet-stat_energy_squared_NIMROD.png" />
<p class="caption"><span class="caption-number">Figure 10.6 </span><span class="caption-text">Energy squared and energy squared perentages, for each threshold and sale, for the NIMROD foreast and analysis, and foreast and analysis En2 and En2% relative differences.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>The En2 bias for each threshold and scale is assessed by the En2 relative difference, equal to the difference between forecast and observed squared energies normalized by their sum: <span class="math notranslate nohighlight">\({En2}(F)- {En2}(O)]/[{En2}(F)+ {En2}(O)]\)</span>. Since defined in such a fashion, the En2 relative difference accounts for the difference between forecast and observation squared energies relative to their magnitude, and it is sensitive therefore to the ratio of the forecast and observed squared energies. The En2 relative difference ranges between -1 and 1, positive values indicate over-forecast and negative values indicate under-forecast. For the NIMROD case illustrated the forecast exhibits over-forecast for small thresholds, quite pronounced on the large scales, and under-forecast for high thresholds.</p>
<p>As for the MSE, the sum of the energy of the scale components is equal to the energy of the original binary field: <span class="math notranslate nohighlight">\({En2}(t) = j \ {En2}(t,j)\)</span>. Therefore, the percentage that the En2 for each scale contributes the total En2 may be computed: for a given threshold, <strong>t</strong>, <span class="math notranslate nohighlight">\({En2\%}(t,j) = {En2}(t,j)/ {En2}(t)\)</span>. Usually, for precipitation fields, low thresholds exhibit most of the energy percentage on large scales (and less percentage on the small scales), since low thresholds are associated to large scale features, such as fronts. On the other hand, for higher thresholds the energy percentage is usually larger on small scales, since intense events are associated to small scales features, such as convective cells or showers. The comparison of the forecast and observation squared energy percentages provides feedback on how the events are distributed across the scales, and enable the comparison of forecast and observation scale structure.</p>
<p>For the NIMROD case illustrated, the scale structure is assessed again by the relative difference, but calculated of the squared energy percentages. For small thresholds the forecast over-estimates the number of large scale events and under-estimates the number of small scale events, in proportion to the total number of events. On the other hand, for larger thresholds the forecast under-estimates the number of large scale events and over-estimates the number of small scale events, again in proportion to the total number of events. Overall it appears that the forecast over-estimates the percentage of events associated to high occurrence, and under-estimate the percentage of events associated to low occurrence. The En2% for the 64 mm/h thresholds is homogeneously under-estimated for all the scales, since the forecast does not have any event exceeding this threshold.</p>
<p>Note that the energy squared of the observation binary field is identical to the sample climatology <span class="math notranslate nohighlight">\({Br}=(a+c)/n\)</span>. Similarly, the energy squared of the forecast binary field is equal to <span class="math notranslate nohighlight">\((a+b)/n\)</span>. The ratio of the squared energies of the forecast and observation binary fields is equal to the <span class="math notranslate nohighlight">\({FBI}=(a+b)/(a+c)\)</span>, for the contingency table (<a class="reference internal" href="#contingency-table-counts"><span class="std std-numref">Table 10.1</span></a>) obtained from the original forecast and observation fields by thresholding with the same threshold used to obtained the binary forecast and observation fields.</p>
</div>
<div class="section" id="the-spatial-domain-constraints">
<h3><span class="section-number">10.2.2. </span>The spatial domain constraints<a class="headerlink" href="#the-spatial-domain-constraints" title="Permalink to this headline">¶</a></h3>
<p>The Intensity-Scale technique is constrained by the fact that orthogonal wavelets (discrete wavelet transforms) are usually performed dyadic domains, square domains of <strong>2ⁿ x 2ⁿ</strong> grid-points. The Wavelet-Stat tool handles this issue based on settings in the configuration file by defining tiles of dimensions <strong>2ⁿ x 2ⁿ</strong> over the input domain in the following ways:</p>
<ol class="arabic simple">
<li><p>User-Defined Tiling: The user may define one or more tiles of size <strong>2ⁿ x 2ⁿ</strong> over their domain to be applied. This is done by selecting the grid coordinates for the lower-left corner of the tile(s) and the tile dimension to be used. If the user specifies more than one tile, the Intensity-Scale method will be applied to each tile separately. At the end, the results will automatically be aggregated across all the tiles and written out with the results for each of the individual tiles. Users are encouraged to select tiles which consist entirely of valid data.</p></li>
<li><p>Automated Tiling: This tiling method is essentially the same as the user-defined tiling method listed above except that the tool automatically selects the location and size of the tile(s) to be applied. It figures out the maximum tile of dimension <strong>2ⁿ x 2ⁿ</strong> that fits within the domain and places the tile at the center of the domain. For domains that are very elongated in one direction, it defines as many of these tiles as possible that fit within the domain.</p></li>
<li><p>Padding: If the domain size is only slightly smaller than <strong>2ⁿ x 2ⁿ</strong>, for certain variables (e.g. precipitation), it is advisable to expand the domain out to <strong>2ⁿ x 2ⁿ</strong> grid-points by adding extra rows and/or columns of fill data. For precipitation variables, a fill value of zero is used. For continuous variables, such as temperature, the fill value is defined as the mean of the valid data in the rest of the field. A drawback to the padding method is the introduction of artificial data into the original field. Padding should only be used when a very small number of rows and/or columns need to be added.</p></li>
</ol>
</div>
<div class="section" id="aggregation-of-statistics-on-multiple-cases">
<h3><span class="section-number">10.2.3. </span>Aggregation of statistics on multiple cases<a class="headerlink" href="#aggregation-of-statistics-on-multiple-cases" title="Permalink to this headline">¶</a></h3>
<p>The Stat-Analysis tool aggregates the intensity scale technique results. Since the results are scale-dependent, it is sensible to aggregate results from multiple model runs (e.g. daily runs for a season) on the same spatial domain, so that the scale components for each singular case will be the same number, and the domain, if not a square domain of <strong>2ⁿ x 2ⁿ</strong> grid-points, will be treated in the same fashion. Similarly, the intensity thresholds for each run should all be the same.</p>
<p>The MSE and forecast and observation squared energy for each scale and thresholds are aggregated simply with a weighted average, where weights are proportional to the number of grid-points used in each single run to evaluate the statistics. If the same domain is always used (and it should) the weights result all the same, and the weighted averaging is a simple mean. For each threshold, the aggregated Br is equal to the aggregated squared energy of the binary observation field, and the aggregated FBI is obtained as the ratio of the aggregated squared energies of the forecast and observation binary fields. From aggregated Br and FBI, the MSErandom for the aggregated runs can be evaluated using the same formula as for the single run. Finally, the Intensity-Scale Skill Score is evaluated by using the aggregated statistics within the same formula used for the single case.</p>
</div>
</div>
<div class="section" id="practical-information">
<h2><span class="section-number">10.3. </span>Practical information<a class="headerlink" href="#practical-information" title="Permalink to this headline">¶</a></h2>
<p>The following sections describe the usage statement, required arguments and optional arguments for the Stat-Analysis tool.</p>
<div class="section" id="wavelet-stat-usage">
<h3><span class="section-number">10.3.1. </span>wavelet_stat usage<a class="headerlink" href="#wavelet-stat-usage" title="Permalink to this headline">¶</a></h3>
<p>The usage statement for the Wavelet-Stat tool is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Usage: wavelet_stat
       fcst_file
       obs_file
       config_file
       [-outdir path]
       [-log file]
       [-v level]
       [-compress level]
</pre></div>
</div>
<p>wavelet_stat has three required arguments and accepts several optional ones.</p>
<div class="section" id="required-arguments-for-wavelet-stat">
<h4><span class="section-number">10.3.1.1. </span>Required arguments for wavelet_stat<a class="headerlink" href="#required-arguments-for-wavelet-stat" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>The <strong>fcst_file</strong> argument is the gridded file containing the model data to be verified.</p></li>
<li><p>The <strong>obs_file</strong> argument is the gridded file containing the observations to be used.</p></li>
<li><p>The <strong>config_file</strong> argument is the configuration file to be used. The contents of the configuration file are discussed below.</p></li>
</ol>
</div>
<div class="section" id="optional-arguments-for-wavelet-stat">
<h4><span class="section-number">10.3.1.2. </span>Optional arguments for wavelet_stat<a class="headerlink" href="#optional-arguments-for-wavelet-stat" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple" start="4">
<li><p>The <strong>-outdir path</strong> indicates the directory where output files should be written.</p></li>
<li><p>The <strong>-log file</strong> option directs output and errors to the specified log file. All messages will be written to that file as well as standard out and error. Thus, users can save the messages without having to redirect the output on the command line. The default behavior is no log file.</p></li>
<li><p>The <strong>-v level</strong> option indicates the desired level of verbosity. The contents of “level” will override the default setting of 2. Setting the verbosity to 0 will make the tool run with no log messages, while increasing the verbosity will increase the amount of logging.</p></li>
<li><p>The <strong>-compress level</strong> option indicates the desired level of compression (deflate level) for NetCDF variables. The valid level is between 0 and 9. The value of “level” will override the default setting of 0 from the configuration file or the environment variable MET_NC_COMPRESS. Setting the compression level to 0 will make no compression for the NetCDF output. Lower number is for fast compression and higher number is for better compression.</p></li>
</ol>
<p>An example of the wavelet_stat calling sequence is listed below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>wavelet_stat \
sample_fcst.grb \
sample_obs.grb \
WaveletStatConfig
</pre></div>
</div>
<p>In the example, the Wavelet-Stat tool will verify the model data in the <strong>sample_fcst.grb</strong> GRIB file using the observations in the <strong>sample_obs.grb</strong> GRIB file applying the configuration options specified in the <strong>WaveletStatConfig</strong> file.</p>
</div>
</div>
<div class="section" id="wavelet-stat-configuration-file">
<span id="id1"></span><h3><span class="section-number">10.3.2. </span>wavelet_stat configuration file<a class="headerlink" href="#wavelet-stat-configuration-file" title="Permalink to this headline">¶</a></h3>
<p>The default configuration file for the Wavelet-Stat tool, <strong>WaveletStatConfig_default</strong>, can be found in the installed <strong>share/met/config</strong> directory. Another version of the configuration file is provided in <strong>scripts/config</strong>. We recommend that users make a copy of the default (or other) configuration file prior to modifying it. The contents are described in more detail below. Note that environment variables may be used when editing configuration files, as described in the <a class="reference internal" href="reformat_point.html#pb2nc-configuration-file"><span class="std std-numref">Section 4.1.2</span></a> for the PB2NC tool.</p>
<hr class="docutils" />
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>model             = &quot;WRF&quot;;
desc              = &quot;NA&quot;;
obtype            = &quot;ANALYS&quot;;
fcst              = { ... }
obs               = { ... }
regrid            = { ... }
mask_missing_flag = NONE;
met_data_dir      = &quot;MET_BASE&quot;;
ps_plot_flag      = TRUE;
fcst_raw_plot     = { color_table = &quot;MET_BASE/colortables/met_default.ctable”;
                      plot_min = 0.0; plot_max = 0.0; }
obs_raw_plot      = { ... }
wvlt_plot         = { ... }
output_prefix     = &quot;&quot;;
version           = &quot;VN.N&quot;;
</pre></div>
</div>
<p>The configuration options listed above are common to many MET tools and are described in <a class="reference internal" href="data_io.html#data-io-met-configuration-file-options"><span class="std std-numref">Section 3.5.1</span></a>.</p>
<hr class="docutils" />
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>grid_decomp_flag = AUTO;

tile = {
   width    = 0;
   location = [ { x_ll = 0; y_ll = 0; } ];
}
</pre></div>
</div>
<p>The <strong>grid_decomp_flag</strong> variable specifies how tiling should be performed:</p>
<ul class="simple">
<li><p><strong>AUTO</strong> indicates that the automated-tiling should be done.</p></li>
<li><p><strong>TILE</strong> indicates that the user-defined tiles should be applied.</p></li>
<li><p><strong>PAD</strong> indicated that the data should be padded out to the nearest dimension of <strong>2ⁿ x 2ⁿ</strong></p></li>
</ul>
<p>The <strong>width</strong> and <strong>location</strong> variables allow users to manually define the tiles of dimension they would like to apply. The x_ll and y_ll variables specify the location of one or more lower-left tile grid (x, y) points.</p>
<hr class="docutils" />
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>wavelet = {
   type   = HAAR;
   member = 2;
}
</pre></div>
</div>
<p>The <strong>wavelet_flag</strong> and <strong>wavelet_k</strong> variables specify the type and shape of the wavelet to be used for the scale decomposition. The <a class="reference internal" href="refs.html#casati-2004"><span class="std std-ref">Casati et al (2004)</span></a> method uses a Haar wavelet which is a good choice for discontinuous fields like precipitation. However, users may choose to apply any wavelet family/shape that is available in the GNU Scientific Library. Values for the <strong>wavelet_flag</strong> variable, and associated choices for k, are described below:</p>
<ul class="simple">
<li><p><strong>HAAR</strong> for the Haar wavelet (member = 2).</p></li>
<li><p><strong>HAAR_CNTR</strong> for the Centered-Haar wavelet (member = 2).</p></li>
<li><p><strong>DAUB</strong> for the Daubechies wavelet (member = 4, 6, 8, 10, 12, 14, 16, 18, 20).</p></li>
<li><p><strong>DAUB_CNTR</strong> for the Centered-Daubechies wavelet (member = 4, 6, 8, 10, 12, 14, 16, 18, 20).</p></li>
<li><p><strong>BSPLINE</strong> for the Bspline wavelet (member = 103, 105, 202, 204, 206, 208, 301, 303, 305, 307, 309).</p></li>
<li><p><strong>BSPLINE_CNTR</strong> for the Centered-Bspline wavelet (member = 103, 105, 202, 204, 206, 208, 301, 303, 305, 307, 309).</p></li>
</ul>
<hr class="docutils" />
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>output_flag = {
   isc = BOTH;
}
</pre></div>
</div>
<p>The <strong>output_flag</strong> array controls the type of output that the Wavelet-Stat tool generates. This flags is set similarly to the output flags of the other MET tools, with possible values of NONE, STAT, and BOTH. The ISC line type is the only one available for Intensity-Scale STAT lines.</p>
<hr class="docutils" />
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nc_pairs_flag = {
   latlon = TRUE;
   raw    = TRUE;
}
</pre></div>
</div>
<p>The nc_pairs_flag is described in <a class="reference internal" href="grid-stat.html#grid-stat-configuration-file"><span class="std std-numref">Section 8.3.2</span></a></p>
</div>
<div class="section" id="wavelet-stat-output">
<span id="id2"></span><h3><span class="section-number">10.3.3. </span>wavelet_stat output<a class="headerlink" href="#wavelet-stat-output" title="Permalink to this headline">¶</a></h3>
<p>wavelet_stat produces output in STAT and, optionally, ASCII and NetCDF and PostScript formats. The ASCII output duplicates the STAT output but has the data organized by line type. While the Wavelet-Stat tool currently only outputs one STAT line type, additional line types may be added in future releases. The output files are written to the default output directory or the directory specified by the -outdir command line option.</p>
<p>The output STAT file is named using the following naming convention:</p>
<p>wavelet_stat_PREFIX_HHMMSSL_YYYYMMDD_HHMMSSV.stat where PREFIX indicates the user-defined output prefix, HHMMSS indicates the forecast lead time, and YYYYMMDD_HHMMSS indicates the forecast valid time.</p>
<p>The output ASCII files are named similarly:</p>
<p>wavelet_stat_PREFIX_HHMMSSL_YYYYMMDD_HHMMSSV_TYPE.txt where TYPE is isc to indicate that this is an intensity-scale line type.</p>
<p>The format of the STAT and ASCII output of the Wavelet-Stat tool is similar to the format of the STAT and ASCII output of the Point-Stat tool. Please refer to the tables in <a class="reference internal" href="point-stat.html#point-stat-output"><span class="std std-numref">Section 7.3.3</span></a> for a description of the common output for STAT files types. The information contained in the STAT and isc files are identical. However, for consistency with the STAT files produced by other tools, the STAT file will only have column headers for the first 21 fields. The isc file contains all headers. The format of the ISC line type is explained in the following table.</p>
<span id="table-ws-header-info-ws-outputs"></span><table class="colwidths-auto docutils align-default" id="id10">
<caption><span class="caption-number">Table 10.2 </span><span class="caption-text">Header information for each file wavelet-stat outputs.</span><a class="headerlink" href="#id10" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>HEADER</p></th>
<th class="head"></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"><p>Column Number</p></th>
<th class="head"><p>Header Column Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1</p></td>
<td><p>VERSION</p></td>
<td><p>Version number</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>MODEL</p></td>
<td><p>User provided text string designating model name</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>DESC</p></td>
<td><p>User provided text string describing the verification task</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>FCST_LEAD</p></td>
<td><p>Forecast lead time in HHMMSS format</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>FCST_VALID_BEG</p></td>
<td><p>Forecast valid start time in YYYYMMDD_HHMMSS format</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>FCST_VALID_END</p></td>
<td><p>Forecast valid end time in YYYYMMDD_HHMMSS format</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>OBS_LEAD</p></td>
<td><p>Observation lead time in HHMMSS format</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>OBS_VALID_BEG</p></td>
<td><p>Observation valid start time in YYYYMMDD_HHMMSS format</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>OBS_VALID_END</p></td>
<td><p>Observation valid end time in YYYYMMDD_HHMMSS format</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>FCST_VAR</p></td>
<td><p>Model variable</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>FCST_UNITS</p></td>
<td><p>Units for model variable</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>FCST_LEV</p></td>
<td><p>Selected Vertical level for forecast</p></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>OBS_VAR</p></td>
<td><p>Observation variable</p></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>OBS_UNITS</p></td>
<td><p>Units for observation variable</p></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>OBS_LEV</p></td>
<td><p>Selected Vertical level for observations</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>OBTYPE</p></td>
<td><p>User provided text string designating the observation type</p></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>VX_MASK</p></td>
<td><p>Verifying masking region indicating the masking grid or polyline region applied</p></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>INTERP_MTHD</p></td>
<td><p>NA in Wavelet-Stat</p></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>INTERP_PNTS</p></td>
<td><p>NA in Wavelet-Stat</p></td>
</tr>
<tr class="row-even"><td><p>20</p></td>
<td><p>FCST_THRESH</p></td>
<td><p>The threshold applied to the forecast</p></td>
</tr>
<tr class="row-odd"><td><p>21</p></td>
<td><p>OBS_THRESH</p></td>
<td><p>The threshold applied to the observations</p></td>
</tr>
<tr class="row-even"><td><p>22</p></td>
<td><p>COV_THRESH</p></td>
<td><p>NA in Wavelet-Stat</p></td>
</tr>
<tr class="row-odd"><td><p>23</p></td>
<td><p>ALPHA</p></td>
<td><p>NA in Wavelet-Stat</p></td>
</tr>
<tr class="row-even"><td><p>24</p></td>
<td><p>LINE_TYPE</p></td>
<td><p>See table below.</p></td>
</tr>
</tbody>
</table>
<span id="table-ws-format-info-isc"></span><table class="colwidths-auto docutils align-default" id="id11">
<caption><span class="caption-number">Table 10.3 </span><span class="caption-text">Format information for the ISC (Intensity-Scale) output line type.</span><a class="headerlink" href="#id11" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>ISC OUTPUT FORMAT</p></th>
<th class="head"></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"><p>Column Number</p></th>
<th class="head"><p>ISC Column Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>24</p></td>
<td><p>ISC</p></td>
<td><p>Intensity-Scale line type</p></td>
</tr>
<tr class="row-even"><td><p>25</p></td>
<td><p>TOTAL</p></td>
<td><p>The number of grid points (forecast locations) used</p></td>
</tr>
<tr class="row-odd"><td><p>26</p></td>
<td><p>TILE_DIM</p></td>
<td><p>The dimensions of the tile</p></td>
</tr>
<tr class="row-even"><td><p>27</p></td>
<td><p>TILE_XLL</p></td>
<td><p>Horizontal coordinate of the lower left corner of the tile</p></td>
</tr>
<tr class="row-odd"><td><p>28</p></td>
<td><p>TILE_YLL</p></td>
<td><p>Vertical coordinate of the lower left corner of the tile</p></td>
</tr>
<tr class="row-even"><td><p>29</p></td>
<td><p>NSCALE</p></td>
<td><p>Total number of scales used in decomposition</p></td>
</tr>
<tr class="row-odd"><td><p>30</p></td>
<td><p>ISCALE</p></td>
<td><p>The scale at which all information following applies</p></td>
</tr>
<tr class="row-even"><td><p>31</p></td>
<td><p>MSE</p></td>
<td><p>Mean squared error for this scale</p></td>
</tr>
<tr class="row-odd"><td><p>32</p></td>
<td><p>ISC</p></td>
<td><p>The intensity scale skill score</p></td>
</tr>
<tr class="row-even"><td><p>33</p></td>
<td><p>FENERGY</p></td>
<td><p>Forecast energy squared for this scale</p></td>
</tr>
<tr class="row-odd"><td><p>34</p></td>
<td><p>OENERGY</p></td>
<td><p>Observed energy squared for this scale</p></td>
</tr>
<tr class="row-even"><td><p>35</p></td>
<td><p>BASER</p></td>
<td><p>The base rate (not scale dependent)</p></td>
</tr>
<tr class="row-odd"><td><p>36</p></td>
<td><p>FBIAS</p></td>
<td><p>The frequency bias</p></td>
</tr>
</tbody>
</table>
<p>The <strong>Wavelet-Stat</strong> tool creates a NetCDF output file containing the raw and decomposed values for the forecast, observation, and difference fields for each combination of variable and threshold value.</p>
<p>The dimensions and variables included in the wavelet_stat NetCDF files are described in Tables <a class="reference internal" href="#table-netcdf-dim-wave-output"><span class="std std-numref">Table 10.4</span></a> and <a class="reference internal" href="#table-variables-wave-netcdf-output"><span class="std std-numref">Table 10.5</span></a>.</p>
<span id="table-netcdf-dim-wave-output"></span><table class="colwidths-auto docutils align-default" id="id12">
<caption><span class="caption-number">Table 10.4 </span><span class="caption-text">Dimensions defined in NetCDF output.</span><a class="headerlink" href="#id12" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>wavelet_stat NetCDF DIMENSIONS</p></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"><p>NetCDF Dimension</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>x</p></td>
<td><p>Dimension of the tile which equals <strong>2ⁿ</strong></p></td>
</tr>
<tr class="row-even"><td><p>y</p></td>
<td><p>Dimension of the tile which equals <strong>2ⁿ</strong></p></td>
</tr>
<tr class="row-odd"><td><p>scale</p></td>
<td><p>Dimension for the number of scales. This is set to <strong>n+2</strong>, where <strong>2ⁿ</strong> is the tile dimension. The 2 extra scales are for the binary image and the wavelet averaged over the whole tile.</p></td>
</tr>
<tr class="row-even"><td><p>tile</p></td>
<td><p>Dimension for the number of tiles used</p></td>
</tr>
</tbody>
</table>
<span id="table-variables-wave-netcdf-output"></span><table class="colwidths-auto docutils align-default" id="id13">
<caption><span class="caption-number">Table 10.5 </span><span class="caption-text">Variables defined in NetCDF output.</span><a class="headerlink" href="#id13" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>wavelet-stat NetCDF VARIABLES</p></th>
<th class="head"></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"><p>NetCDF Variable</p></th>
<th class="head"><p>Dimension</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>FCST_FIELD_LEVEL_RAW</p></td>
<td><p>tile, x, y</p></td>
<td><p>Raw values for the forecast field specified by “FIELD_LEVEL”</p></td>
</tr>
<tr class="row-even"><td><p>OBS_FIELD_LEVEL_RAW</p></td>
<td><p>tile, x, y</p></td>
<td><p>Raw values for the observation field specified by “FIELD_LEVEL”</p></td>
</tr>
<tr class="row-odd"><td><p>DIFF_FIELD_LEVEL_RAW</p></td>
<td><p>tile, x, y</p></td>
<td><p>Raw values for the difference field (<strong>f-o</strong>) specified by “FIELD_LEVEL”</p></td>
</tr>
<tr class="row-even"><td><p>FCST_FIELD_LEVEL_THRESH</p></td>
<td><p>tile, scale, x, y</p></td>
<td><p>Wavelet scale-decomposition of the forecast field specified by “FIELD_LEVEL_THRESH”</p></td>
</tr>
<tr class="row-odd"><td><p>OBS_FIELD_LEVEL_THRESH</p></td>
<td><p>tile, scale, x, y</p></td>
<td><p>Wavelet scale-decomposition of the observation field specified by “FIELD_LEVEL_THRESH”</p></td>
</tr>
</tbody>
</table>
<p>Lastly, the <strong>Wavelet-Stat</strong> tool creates a PostScript plot summarizing the scale-decomposition approach used in the verification. The PostScript plot is generated using internal libraries and does not depend on an external plotting package. The generation of this PostScript output can be disabled using the <strong>ps_plot_flag</strong> configuration file option.</p>
<p>The PostScript plot begins with one summary page illustrating the tiling method that was applied to the domain. The remaining pages depict the Intensity-Scale method that was applied. For each combination of field, tile, and threshold, the binary difference field (<strong>f-o</strong>) is plotted followed by the difference field for each decomposed scale. Underneath each difference plot, the statistics applicable to that scale are listed. Examples of the PostScript plots can be obtained by running the example cases provided with the MET tarball.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gsi-tools.html" class="btn btn-neutral float-right" title="11. GSI Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ensemble-stat.html" class="btn btn-neutral" title="9. Ensemble-Stat Tool" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, UCAR/NCAR, NOAA, and CSU/CIRA.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'9.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>